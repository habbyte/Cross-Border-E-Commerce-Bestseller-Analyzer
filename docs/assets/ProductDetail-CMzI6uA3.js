import{_ as w,r as I,z as W,c as u,o as m,a as o,b as S,t as a,w as B,m as y,j as F,p as P,F as N,e as z,u as E,g as L,q as V,s as g,h as v,i as q}from"./index-DZqF_wLK.js";import{T as R}from"./TriState-ij1TnVMO.js";const U={name:"ProductDetail",components:{TriState:R},props:{id:{type:String,required:!0}},setup(s){const c=E(),d=L(),{t}=V(),_=g(!0),h=g(""),n=g(!1),l=g(null),r=v(()=>d.isWatched(s.id)),p=v(()=>d.isInCompare(s.id)),e=v(()=>`https://via.placeholder.com/300x300?text=${encodeURIComponent(t("common.product"))}`),b=i=>({low:t("productDetail.competition.low"),medium:t("productDetail.competition.medium"),high:t("productDetail.competition.high")})[i]||i,f=()=>{d.toggleWatch(s.id)},D=()=>{p.value||d.addToCompare(s.id)},k=()=>{c.go(-1)},T=i=>{navigator.clipboard.writeText(i).then(()=>{n.value=!0,setTimeout(()=>{n.value=!1},2e3)}).catch(C=>{console.error("å¤åˆ¶å¤±è´¥:",C)})};return q(async()=>{try{_.value=!0,h.value="",d.isInitialized||await d.initialize();try{l.value=await d.getProduct(s.id)}catch(i){h.value=(i==null?void 0:i.message)||"Failed to load product",l.value=null,console.error("[ProductDetail] Failed to load product:",i)}}finally{_.value=!1}}),{product:l,loading:_,detailError:h,isWatched:r,isInCompare:p,showCopyNotification:n,placeholderImage:e,getCompetitionText:b,toggleWatch:f,addToCompare:D,goBack:k,copyToClipboard:T,t}}},j={class:"product-detail"},M={class:"page-header"},x={class:"page-title"},A={key:0,class:"product-content"},G={class:"product-header"},H={class:"product-image"},J=["src","alt"],K={class:"product-info"},O={class:"product-title"},Q={class:"product-meta"},X={class:"product-platform"},Y={class:"product-category"},Z={class:"product-stats"},$={class:"stat-item"},tt={class:"stat-label"},ot={class:"stat-value price"},st={class:"stat-item"},at={class:"stat-label"},et={class:"stat-value"},it={class:"stat-item"},ct={class:"stat-label"},dt={class:"stat-value"},rt={class:"stat-item"},nt={class:"stat-label"},lt={class:"product-actions"},pt=["disabled"],ut={class:"product-details"},mt={class:"detail-section"},_t={class:"detail-title"},ht={class:"detail-content"},gt={class:"detail-section"},vt={class:"detail-title"},bt={class:"keywords"},Ct={class:"keyword-text"},yt=["onClick"],ft={key:0,class:"copy-notification"};function Dt(s,c,d,t,_,h){const n=I("TriState"),l=W("img-fallback");return m(),u("div",j,[o("div",M,[o("button",{class:"btn btn-ghost back-btn",onClick:c[0]||(c[0]=(...r)=>t.goBack&&t.goBack(...r))},a(s.$t("productDetail.goBack")),1),o("h1",x," ğŸ“¦ "+a(s.$t("productDetail.title")),1)]),S(n,{loading:t.loading,error:t.detailError,empty:t.product?0:1,"empty-text":s.$t("productDetail.notFound")},{default:B(()=>{var r,p;return[t.product?(m(),u("div",A,[o("div",G,[o("div",H,[F(o("img",{src:((r=t.product)==null?void 0:r.imageUrl)||t.placeholderImage,alt:((p=t.product)==null?void 0:p.title)||t.t("common.product")},null,8,J),[[l]])]),o("div",K,[o("h2",O,a(t.product.title),1),o("div",Q,[o("span",X,a(t.product.platform),1),o("span",Y,a(t.product.category),1)]),o("div",Z,[o("div",$,[o("span",tt,a(s.$t("productDetail.price")),1),o("span",ot,a(t.product.formattedPrice),1)]),o("div",st,[o("span",at,a(s.$t("productDetail.sales")),1),o("span",et,a(t.product.sales.toLocaleString()),1)]),o("div",it,[o("span",ct,a(s.$t("productDetail.rating")),1),o("span",dt,a(t.product.rating)+"/5",1)]),o("div",rt,[o("span",nt,a(s.$t("productDetail.competitionLabel")),1),o("span",{class:P(["stat-value",`competition-${t.product.competition}`])},a(t.getCompetitionText(t.product.competition)),3)])]),o("div",lt,[o("button",{class:"btn btn-primary",onClick:c[1]||(c[1]=(...e)=>t.toggleWatch&&t.toggleWatch(...e))},a(t.isWatched?s.$t("productDetail.removeFromWatchlist"):s.$t("productDetail.addToWatchlist")),1),o("button",{class:"btn btn-secondary",disabled:t.isInCompare,onClick:c[2]||(c[2]=(...e)=>t.addToCompare&&t.addToCompare(...e))},a(t.isInCompare?s.$t("productDetail.removeFromCompare"):s.$t("productDetail.addToCompare")),9,pt)])])]),o("div",ut,[o("div",mt,[o("h3",_t,a(s.$t("productDetail.description")),1),o("p",ht,a(t.product.description||s.$t("productDetail.noDescription")),1)]),o("div",gt,[o("h3",vt,a(s.$t("productDetail.keywords")),1),o("div",bt,[(m(!0),u(N,null,z(t.product.tags||[],e=>(m(),u("div",{key:e,class:"keyword-tag"},[o("span",Ct,a(e),1),o("button",{class:"copy-btn",title:"å¤åˆ¶å…³é”®è¯",onClick:b=>t.copyToClipboard(e)}," ğŸ“‹ ",8,yt)]))),128))]),t.showCopyNotification?(m(),u("div",ft," å¤åˆ¶æˆåŠŸï¼ ")):y("",!0)])])])):y("",!0)]}),_:1},8,["loading","error","empty","empty-text"])])}const wt=w(U,[["render",Dt],["__scopeId","data-v-a95165dc"]]);export{wt as default};
